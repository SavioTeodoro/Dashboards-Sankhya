<gadget>
  <prompt-parameters>
    <parameter id="PERIODO" description="Periodo" metadata="datePeriod" required="true" keep-last="true" keep-date="false" order="0"/>
    <parameter id="EMPRESA" description="Empresa" metadata="multiList:Text" listType="sql" required="true" keep-last="true" keep-date="false" order="1">
      <expression type="SQL"><![CDATA[SELECT CODEMP AS VALUE,
TO_CHAR(CODEMP) || ' - ' || RAZAOABREV AS LABEL
FROM TSIEMP ORDER BY 1]]></expression>
    </parameter>
    <parameter id="CODCENCUS" description="Cod. Centro Resultado" metadata="multiList:Text" listType="sql" required="true" keep-last="true" keep-date="false" order="2">
      <expression type="SQL"><![CDATA[SELECT CODCENCUS AS VALUE, CODCENCUS ||'-'||DESCRCENCUS AS LABEL FROM TSICUS WHERE ANALITICO='S' ORDER BY 1]]></expression>
    </parameter>
    <parameter id="CODBCO" description="Conta Bancaria" metadata="multiList:Text" listType="sql" required="false" keep-last="true" keep-date="false" order="3">
      <expression type="SQL"><![CDATA[SELECT CODCTABCOINT AS VALUE,
TO_CHAR(CODCTABCOINT) || ' - ' || DESCRICAO AS LABEL
FROM TSICTA 
ORDER BY 1]]></expression>
    </parameter>
  </prompt-parameters>
  <local-vars>
    <var id="V_LOGO">
      <expression type="sql" data-source="MGEDS"><![CDATA[SELECT 
'<div class="img"><img src="https://http2.mlstatic.com/storage/mshops-appearance-api/images/41/257545041/logo-2020071616504400800.png" width="30%"></div>'
FROM DUAL

]]></expression>
    </var>
  </local-vars>
  <level id="lvl_a6616yh" description="Principal">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="H" tamanhoRelativo="135">
        <container orientacao="V" tamanhoRelativo="33">
          <simple-value id="svl_aku49f9">
            <value-expression><![CDATA[
$V_LOGO
<style>
 .img {  
position: relative;
width: 40%;
margin-left: 450px;
padding: 20px;
flex-direction: row;
display: flex;
 justify-content: center;
align-items: center;
}
.reset {  
position: relative;
width: 50%;
margin-left: 800px;
padding: 20px;
flex-direction: row;
display: flex;
align-items: center;
    }
</syle>




]]></value-expression>
          </simple-value>
        </container>
      </container>
      <container orientacao="V" tamanhoRelativo="696">
        <grid id="grd_a6616yi" multiplaSelecao="S" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[WITH DADOS AS (

  SELECT Z.*
	, CASE WHEN ORDEM IN (1,3,5,6,8, 9,11, 13, 15, 16, 18, 19) THEN '#2A7344' END AS BKCOLOR
	, CASE WHEN ORDEM IN (1,3,5,6,8, 9,11, 13, 15, 16, 18, 19) THEN '#ffffff' END AS FGCOLOR

FROM
(
SELECT 1000 AS CODNAT
		, ' CONTA BANCARIA SALDO INICIAL' AS DESCRNAT
		, 1 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 01 THEN  (SBC.SALDOREAL) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 02 THEN  (SBC.SALDOREAL) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 03 THEN  (SBC.SALDOREAL) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 04 THEN  (SBC.SALDOREAL) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 05 THEN  (SBC.SALDOREAL) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 06 THEN  (SBC.SALDOREAL) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 07 THEN  (SBC.SALDOREAL) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 08 THEN  (SBC.SALDOREAL) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 09 THEN  (SBC.SALDOREAL) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 10 THEN  (SBC.SALDOREAL) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 11 THEN  (SBC.SALDOREAL) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(SBC.REFERENCIA,'MM') = 12 THEN  (SBC.SALDOREAL) ELSE 0 END) AS DEZEMBRO
		, SUM((0) ) AS TOTAL

 FROM TGFSBC SBC
         INNER JOIN TSICTA CTA
         ON CTA.CODCTABCOINT = SBC.CODCTABCOINT
         
 WHERE SBC.REFERENCIA BETWEEN :PERIODO.INI AND :PERIODO.FIN
AND CTA.CODEMP IN :EMPRESA AND CTA.CODCTABCOINT IN :CODBCO

UNION ALL


SELECT 10000 AS CODNAT
		, ' RECEITA OPERACIONAL' AS DESCRNAT
		, 1 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCENCUS IN :CODCENCUS
AND SUBSTR(FIN.CODNAT,1,4) IN(1101, 1103)
AND FIN.CODCTABCOINT IN :CODBCO


UNION ALL 

SELECT PAI.CODNAT
		,  PAI.DESCRNAT
		, 2 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 WHERE  FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODCENCUS IN :CODCENCUS
AND SUBSTR(FIN.CODNAT,1,4) IN (1101, 1103)
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCTABCOINT IN :CODBCO
GROUP BY  PAI.CODNAT
		, PAI.DESCRNAT

 

UNION ALL  

SELECT 10000
		, '( = ) RECEITA LÍQUIDA'
		, 3 AS ORDEM

		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODCENCUS IN :CODCENCUS
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCTABCOINT IN :CODBCO
AND SUBSTR(FIN.CODNAT,1,2) IN (11)

	
UNION ALL /* SUBTOTAL DE RECEITAS (-) CUSTOS (MARGEM BRUTA) */

SELECT 10000 AS CODNAT
		, ' DEDUÇÕES DA RECEITA' AS DESCRNAT
		, 1 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCENCUS IN :CODCENCUS
AND SUBSTR(FIN.CODNAT,1,4) IN (1102)
AND FIN.CODCTABCOINT IN :CODBCO


UNION ALL 

SELECT PAI.CODNAT
		, PAI.DESCRNAT
		, 4 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODCENCUS IN :CODCENCUS
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCTABCOINT IN :CODBCO
AND SUBSTR(FIN.CODNAT,1,4) IN (1102)
GROUP BY PAI.CODNAT,PAI.DESCRNAT

UNION ALL

SELECT 10000 AS CODNAT
		, ' CUSTO DE MERCADORIA' AS DESCRNAT
		, 1 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCENCUS IN :CODCENCUS
AND SUBSTR(FIN.CODNAT,1,2) IN(12)
AND FIN.CODCTABCOINT IN :CODBCO


UNION ALL 

SELECT PAI.CODNAT
		, PAI.DESCRNAT
		, 4 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODCENCUS IN :CODCENCUS
AND FIN.CODEMP IN :EMPRESA
AND FIN.CODCTABCOINT IN :CODBCO
AND SUBSTR(FIN.CODNAT,1,2) IN(12)
GROUP BY PAI.CODNAT,PAI.DESCRNAT

UNION ALL

SELECT 20000
		, '( = ) MARGEM BRUTA'
		, 5 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODCENCUS IN :CODCENCUS
AND FIN.CODCTABCOINT IN :CODBCO
AND FIN.CODEMP IN :EMPRESA
AND SUBSTR(FIN.CODNAT,1,2) IN (11,12)

UNION ALL /* TOTALIZADOR TITULO: DESPESAS OPERACIONAIS - GRUPO 12/13 NATUREZA */

SELECT 3000
		, 'DESPESA OPERACIONAL'
		, 6 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODCTABCOINT IN :CODBCO
	AND FIN.CODEMP IN :EMPRESA
	AND SUBSTR(FIN.CODNAT,1,2) IN(13)
    AND SUBSTR(FIN.CODNAT,1,4) NOT IN(1308)

UNION ALL
/* DETALHAMENTO DESPESAS */

SELECT PAI.CODNAT
		, PAI.DESCRNAT
		, 7 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
	AND SUBSTR(FIN.CODNAT,1,2) IN(13)
    AND SUBSTR(FIN.CODNAT,1,4) NOT IN(1308)
		
 GROUP BY  PAI.CODNAT
		, PAI.DESCRNAT

UNION ALL /* SUBTOTAL DE RECEITAS - CUSTO - DESPESA */

SELECT 30000
		, '( = ) RESULTADO OPERACIONAL '
		, 8 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
	AND SUBSTR(FIN.CODNAT,1,2) IN (11, 12, 13)
    AND SUBSTR(FIN.CODNAT,1,4) NOT IN(1308)
	
UNION ALL /* OUTROS GRUPOS */

SELECT 3000
		, 'DESPESA/ RECEITAS FINANCEIRAS'
		, 9 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL



 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODCTABCOINT IN :CODBCO
	AND FIN.CODEMP IN :EMPRESA
	AND SUBSTR(FIN.CODNAT,1,2) IN (13)
    AND SUBSTR(FIN.CODNAT,1,4) IN(1308)

UNION ALL

SELECT PAI.CODNAT
		, PAI.DESCRNAT
		, 10 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
	AND SUBSTR(FIN.CODNAT,1,2) IN (13)
    AND SUBSTR(FIN.CODNAT,1,4) IN(1308)
	GROUP BY  PAI.CODNAT
	, PAI.DESCRNAT

	UNION ALL

SELECT 3000
		, 'INVESTIMENTOS'
		, 11 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODCTABCOINT IN :CODBCO
	AND FIN.CODEMP IN :EMPRESA
	AND SUBSTR(FIN.CODNAT,1,2) IN(14)

UNION ALL

SELECT PAI.CODNAT
		, PAI.DESCRNAT
		, 12 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
	AND SUBSTR(FIN.CODNAT,1,2) IN(14)
	 GROUP BY  PAI.CODNAT
		, PAI.DESCRNAT

	UNION ALL
	
SELECT 3000
		, 'DESPESAS DIVERSAS'
		, 13 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODCTABCOINT IN :CODBCO
	AND FIN.CODEMP IN :EMPRESA
	AND SUBSTR(FIN.CODNAT,1,2) IN(16, 17)

UNION ALL	

	SELECT PAI.CODNAT
			, PAI.DESCRNAT
			, 14 AS ORDEM
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
			, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
			, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
	 
	 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
		AND FIN.PROVISAO <> 'S'
 	    AND FIN.NUCOMPENS IS NULL
		AND FIN.CODCENCUS IN :CODCENCUS
		AND FIN.CODEMP IN :EMPRESA
		AND FIN.CODCTABCOINT IN :CODBCO
	    AND SUBSTR(FIN.CODNAT,1,2) IN(16, 17)
		
	 GROUP BY  PAI.CODNAT
			, PAI.DESCRNAT
			
UNION ALL /* TOTAL GERAL*/

SELECT 10000000
		, '( = ) RESULTADO LIQUIDO'
		, 15 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'

 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
	AND SUBSTR(FIN.CODNAT,1,2) IN (11, 12, 13, 14, 16, 17)

	UNION ALL 

	SELECT 3000
		, 'DISTRIBUIÇÃO DE LUCROS'
		, 16 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODCTABCOINT IN :CODBCO
	AND FIN.CODEMP IN :EMPRESA
	AND SUBSTR(FIN.CODNAT,1,2) IN(15)

UNION ALL

SELECT PAI.CODNAT
		, PAI.DESCRNAT
		, 17 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
 	AND SUBSTR(FIN.CODNAT,1,2) IN(15)
		 GROUP BY  PAI.CODNAT
			, PAI.DESCRNAT

	UNION ALL
	
	SELECT 10000000
		, '( = ) RESULTADO LIQUIDO APÓS DISTRIBUIÇÃO DE LUCROS'
		, 18 AS ORDEM
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
 
 WHERE FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND FIN.PROVISAO <> 'S'
 	AND FIN.NUCOMPENS IS NULL
	AND FIN.CODCENCUS IN :CODCENCUS
	AND FIN.CODEMP IN :EMPRESA
	AND FIN.CODCTABCOINT IN :CODBCO
	AND SUBSTR(FIN.CODNAT,1,2) IN (11, 12, 13, 14, 15, 16)
	
)Z
ORDER BY ORDEM,CODNAT
)

SELECT 
    CODNAT
    , DESCRNAT
    , ORDEM
    , JANEIRO
    , FEVEREIRO
    , MARCO
    , ABRIL
    , MAIO
    , JUNHO
    , JULHO
    , AGOSTO
    , SETEMBRO
    , OUTUBRO
    , NOVEMBRO
    , DEZEMBRO
    , FGCOLOR
    , BKCOLOR
FROM
    DADOS D 

UNION ALL

SELECT
    2000000 AS CODNAT
    , 'CONTA BANCARIA SALDO FINAL'  AS DESCRNAT
    ,  19 AS ORDEM
    , (D2.JANEIRO + D3.JANEIRO) AS JANEIRO
    , (D2.FEVEREIRO + D3.FEVEREIRO) AS FEVEREIRO
    , (D2.MARCO + D3.MARCO) AS MARCO
    , (D2.ABRIL + D3.ABRIL) AS ABRIL
    , (D2.MAIO + D3.MAIO) AS MAIO
    , (D2.JUNHO + D3.JUNHO) AS JUNHO
    , (D2.JULHO + D3.JULHO) AS JULHO
    , (D2.AGOSTO + D3.AGOSTO) AS AGOSTO
    , (D2.SETEMBRO + D3.SETEMBRO) AS SETEMBRO
    , (D2.OUTUBRO + D3.OUTUBRO) AS OUTUBRO
    , (D2.NOVEMBRO + D3.NOVEMBRO) AS NOVEMBRO
    , (D2.DEZEMBRO + D3.DEZEMBRO) AS DEZEMBRO
    , D2.FGCOLOR
    , D2.BKCOLOR

FROM 
    DADOS D2, DADOS D3 
WHERE
    D2.DESCRNAT = ' CONTA BANCARIA SALDO INICIAL' AND D3.DESCRNAT ='( = ) RESULTADO LIQUIDO APÓS DISTRIBUIÇÃO DE LUCROS']]></expression>
          <metadata>
            <field name="CODNAT" label="Código Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Descrição Natureza" type="S" visible="true" useFooter="false"/>
            <field name="ORDEM" label="Ordem" type="F" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Janeiro" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="FEVEREIRO" label="Fevereiro" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="MARCO" label="Março" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="ABRIL" label="Abril" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="MAIO" label="Maio" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="JUNHO" label="Junho" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="JULHO" label="Julho" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="AGOSTO" label="Agosto" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="SETEMBRO" label="Setembro" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="OUTUBRO" label="Outubro" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="NOVEMBRO" label="Novembro" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="DEZEMBRO" label="Dezembro" type="F" visible="true" useFooter="false" mask="#.##0,00;-n"/>
            <field name="FGCOLOR" label="FGCOLOR" type="S" visible="false" useFooter="false"/>
            <field name="BKCOLOR" label="BKCOLOR" type="S" visible="false" useFooter="false"/>
          </metadata>
          <on-click navigate-to="lvl_a6616yv">
            <param id="A_CODNAT">$CODNAT</param>
          </on-click>
        </grid>
      </container>
    </container>
  </level>
  <level id="lvl_a6616yv" description="Det">
    <args>
      <arg id="A_CODNAT" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_a6616yx" multiplaSelecao="S" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT X.CODNAT AS CODNAT
		, X.DESCRNAT AS DESCRNAT
		, SUM(X.JANEIRO) AS JANEIRO
		, SUM(X.FEVEREIRO) AS FEVEREIRO
		, SUM(X.MARCO) AS MARCO
		, SUM(X.ABRIL) AS ABRIL
		, SUM(X.MAIO) AS MAIO
		, SUM(X.JUNHO) AS JUNHO
		, SUM(X.JULHO) AS JULHO
		, SUM(X.AGOSTO) AS AGOSTO
		, SUM(X.SETEMBRO) AS SETEMBRO
		, SUM(X.OUTUBRO) AS OUTUBRO
		, SUM(X.NOVEMBRO) AS NOVEMBRO
		, SUM(X.DEZEMBRO) AS DEZEMBRO
		, SUM(X.TOTAL) AS TOTAL
FROM (
SELECT NAT.CODNAT AS CODNAT
		, NAT.DESCRNAT AS DESCRNAT
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 01 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JANEIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 02 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 03 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MARCO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 04 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS ABRIL
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 05 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS MAIO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 06 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JUNHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 07 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS JULHO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 08 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS AGOSTO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 09 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS SETEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 10 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS OUTUBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 11 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO
		, SUM(CASE WHEN TO_CHAR(FIN.DHBAIXA,'MM') = 12 THEN  (FIN.VLRBAIXA * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO
		, SUM((FIN.VLRBAIXA * FIN.RECDESP) ) AS TOTAL

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
INNER JOIN TGFNAT PAI ON NAT.CODNATPAI = PAI.CODNAT
INNER JOIN TGFTOP TPO ON TPO.CODTIPOPER = FIN.CODTIPOPER AND FIN.DHTIPOPER = TPO.DHALTER
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO
				LEFT JOIN TSICTA CTA ON CTA.CODCTABCOINT = MBC.CODCTABCOINT
 
WHERE FIN.PROVISAO <> 'S'
AND FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
AND (PAI.CODNAT = :A_CODNAT) 
 	AND FIN.NUCOMPENS IS NULL
/*	AND FIN.CODTIPOPER IN :CODTIPOPER*/
AND FIN.CODCENCUS IN :CODCENCUS
AND FIN.CODEMP IN :EMPRESA
GROUP BY NAT.CODNAT
		, NAT.DESCRNAT, FIN.DHBAIXA
) X
GROUP BY X.CODNAT, X.DESCRNAT
ORDER BY X.CODNAT
]]></expression>
          <metadata>
            <field name="CODNAT" label="Cod. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Janeiro" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEVEREIRO" label="Fevereiro" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MARCO" label="Março" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABRIL" label="Abril" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAIO" label="Maio" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUNHO" label="Junho" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JULHO" label="Julho" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGOSTO" label="Agosto" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SETEMBRO" label="Setembro" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUTUBRO" label="Outubro" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOVEMBRO" label="Novembro" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZEMBRO" label="Dezembro" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
          </metadata>
          <refresh-details ui-list="grd_uulk9l">
            <param id="P_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_uulk9l" useNewGrid="S">
          <args>
            <arg id="P_CODNAT" type="integer"/>
            <arg id=" " type="date"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT NAT.CODNAT
		, NAT.DESCRNAT
		, FIN.NUFIN
		, FIN.CODPARC
		, PAR.RAZAOSOCIAL
		, FIN.DHBAIXA
		, TO_CHAR(FIN.DHBAIXA,'MM') AS MES
		, CTA.CODCTABCOINT || ' ' || nvl(CTA.DESCRICAO,'COMPENSAÇÃO') AS CONTA
		, (FIN.VLRBAIXA * FIN.RECDESP) AS VALOR
      , FIN.CODTIPTIT
		, FIN.HISTORICO
,FIN.CODTIPOPER
,TPO.DESCROPER

 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
INNER JOIN TGFNAT PAI ON NAT.CODNATPAI = PAI.CODNAT
INNER JOIN TGFTOP TPO ON TPO.CODTIPOPER = FIN.CODTIPOPER AND FIN.DHTIPOPER = TPO.DHALTER
				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI
				LEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO
				LEFT JOIN TSICTA CTA ON CTA.CODCTABCOINT = MBC.CODCTABCOINT
 
 WHERE FIN.PROVISAO <> 'S'
AND FIN.DHBAIXA BETWEEN :PERIODO.INI AND :PERIODO.FIN
	AND NAT.CODNAT = :P_CODNAT
 	AND FIN.NUCOMPENS IS NULL
AND FIN.CODCENCUS IN :CODCENCUS
AND FIN.CODEMP IN :EMPRESA
ORDER BY FIN.DHBAIXA
]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Nat" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="NUFIN" label="Nr. Único" type="I" visible="true" useFooter="false"/>
            <field name="CODPARC" label="Cód. Par" type="I" visible="true" useFooter="false"/>
            <field name="RAZAOSOCIAL" label="Parceiro" type="S" visible="true" useFooter="false"/>
            <field name="DHBAIXA" label="Dt. Baixa" type="D" visible="true" useFooter="false" mask="DD/MM/YYYY"/>
            <field name="MES" label="MES" type="S" visible="true" useFooter="false"/>
            <field name="CONTA" label="Conta" type="S" visible="true" useFooter="false"/>
            <field name="VALOR" label="Valor" type="I" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="CODTIPTIT" label="Tipo Titulo" type="I" visible="true" useFooter="false"/>
            <field name="HISTORICO" label="Histórico" type="S" visible="true" useFooter="false"/>
            <field name="CODTIPOPER" label="Cód. TOP" type="I" visible="true" useFooter="false"/>
            <field name="DESCROPER" label="TOP" type="S" visible="true" useFooter="false"/>
          </metadata>
          <on-click-launcher resource-id="br.com.sankhya.fin.cad.movimentacaoFinanceira">
            <NUFIN>$NUFIN</NUFIN>
          </on-click-launcher>
        </grid>
      </container>
    </container>
  </level>
</gadget>
